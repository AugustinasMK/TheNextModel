/scratch/lustre/home/auma4493/TheNextModel/FinalEvaluation
args: Namespace(batch_size=32, dataset='glv2_t', model_checkpoint='/scratch/lustre/home/auma4493/TheNextModel/FinalTraining/checkpoints/disc/trained_model_18_20.pth', model_name='google/vit-large-patch16-224', model_type='disc', use_GeM=True)
Resolving data files:   0%|          | 0/138520 [00:00<?, ?it/s]Resolving data files:  17%|█▋        | 23295/138520 [00:00<00:00, 232929.12it/s]Resolving data files:  34%|███▍      | 46903/138520 [00:00<00:00, 234769.80it/s]Resolving data files:  51%|█████     | 70859/138520 [00:00<00:00, 236951.17it/s]Resolving data files:  68%|██████▊   | 94555/138520 [00:00<00:00, 219637.05it/s]Resolving data files:  84%|████████▍ | 116694/138520 [00:00<00:00, 200299.82it/s]Resolving data files:  99%|█████████▉| 137038/138520 [00:01<00:00, 39561.72it/s] Resolving data files: 100%|██████████| 138520/138520 [00:02<00:00, 60869.51it/s]
Resolving data files:   0%|          | 0/1129 [00:00<?, ?it/s]Resolving data files: 100%|██████████| 1129/1129 [00:00<00:00, 26256.26it/s]
Resolving data files:   0%|          | 0/10000 [00:00<?, ?it/s]Resolving data files:  85%|████████▌ | 8504/10000 [00:00<00:00, 81826.18it/s]Resolving data files: 100%|██████████| 10000/10000 [00:00<00:00, 33961.45it/s]
Found cached dataset imagefolder (/scratch/lustre/home/auma4493/.cache/huggingface/datasets/imagefolder/glv2-next-final-f1222a0f34855ac2/0.0.0/37fbb85cc714a338bea574ac6c7d0b5be5aff46c1862c1989b20e0771199e93f)
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:00<00:01,  1.65it/s] 67%|██████▋   | 2/3 [00:01<00:00,  1.68it/s]100%|██████████| 3/3 [00:01<00:00,  1.72it/s]100%|██████████| 3/3 [00:01<00:00,  1.70it/s]
main dataset:  DatasetDict({
    train: Dataset({
        features: ['image'],
        num_rows: 138520
    })
    test: Dataset({
        features: ['image'],
        num_rows: 1129
    })
    validation: Dataset({
        features: ['image'],
        num_rows: 10000
    })
})
Resolving data files:   0%|          | 0/100000 [00:00<?, ?it/s]Resolving data files:  34%|███▍      | 34014/100000 [00:00<00:00, 340121.67it/s]Resolving data files:  68%|██████▊   | 68027/100000 [00:00<00:00, 292595.28it/s]Resolving data files:  98%|█████████▊| 97710/100000 [00:00<00:00, 144841.16it/s]Resolving data files: 100%|██████████| 100000/100000 [00:01<00:00, 96055.02it/s]
Resolving data files:   0%|          | 0/10000 [00:00<?, ?it/s]Resolving data files:  17%|█▋        | 1706/10000 [00:00<00:00, 16139.87it/s]Resolving data files:  33%|███▎      | 3320/10000 [00:00<00:00, 6862.83it/s] Resolving data files:  43%|████▎     | 4268/10000 [00:00<00:00, 6047.33it/s]Resolving data files:  50%|█████     | 5005/10000 [00:00<00:00, 5268.54it/s]Resolving data files:  56%|█████▌    | 5610/10000 [00:00<00:00, 5366.85it/s]Resolving data files:  62%|██████▏   | 6199/10000 [00:01<00:00, 5156.73it/s]Resolving data files:  67%|██████▋   | 6745/10000 [00:01<00:00, 4917.35it/s]Resolving data files:  73%|███████▎  | 7325/10000 [00:01<00:00, 5022.49it/s]Resolving data files:  78%|███████▊  | 7841/10000 [00:01<00:00, 4930.83it/s]Resolving data files:  83%|████████▎ | 8343/10000 [00:01<00:00, 4893.46it/s]Resolving data files:  88%|████████▊ | 8838/10000 [00:01<00:00, 4728.38it/s]Resolving data files:  93%|█████████▎| 9343/10000 [00:01<00:00, 4639.62it/s]Resolving data files: 100%|██████████| 10000/10000 [00:01<00:00, 5475.20it/s]
Resolving data files:   0%|          | 0/100000 [00:00<?, ?it/s]Resolving data files:  22%|██▏       | 21548/100000 [00:00<00:00, 215439.11it/s]Resolving data files:  45%|████▌     | 45246/100000 [00:00<00:00, 225309.92it/s]Resolving data files:  72%|███████▏  | 72128/100000 [00:00<00:00, 245037.21it/s]Resolving data files:  97%|█████████▋| 96641/100000 [00:01<00:00, 51631.68it/s] Resolving data files: 100%|██████████| 100000/100000 [00:02<00:00, 49384.72it/s]
Found cached dataset imagefolder (/scratch/lustre/home/auma4493/.cache/huggingface/datasets/imagefolder/disc21-next-final-453d375012a0d071/0.0.0/37fbb85cc714a338bea574ac6c7d0b5be5aff46c1862c1989b20e0771199e93f)
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:00<00:01,  1.29it/s] 67%|██████▋   | 2/3 [00:01<00:00,  1.31it/s]100%|██████████| 3/3 [00:02<00:00,  1.32it/s]100%|██████████| 3/3 [00:02<00:00,  1.32it/s]
Some weights of the model checkpoint at google/vit-large-patch16-224 were not used when initializing ViTModel: ['classifier.weight', 'classifier.bias']
- This IS expected if you are initializing ViTModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ViTModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ViTModel were not initialized from the model checkpoint at google/vit-large-patch16-224 and are newly initialized: ['vit.pooler.dense.bias', 'vit.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Loading cached processed dataset at /scratch/lustre/home/auma4493/.cache/huggingface/datasets/imagefolder/glv2-next-final-f1222a0f34855ac2/0.0.0/37fbb85cc714a338bea574ac6c7d0b5be5aff46c1862c1989b20e0771199e93f/cache-15e809b1b6ebb82c.arrow
Loading cached processed dataset at /scratch/lustre/home/auma4493/.cache/huggingface/datasets/imagefolder/disc21-next-final-453d375012a0d071/0.0.0/37fbb85cc714a338bea574ac6c7d0b5be5aff46c1862c1989b20e0771199e93f/cache-acf58726bdb91fc7.arrow
train dataset:  DatasetDict({
    train: Dataset({
        features: ['image'],
        num_rows: 100000
    })
    test: Dataset({
        features: ['image'],
        num_rows: 10000
    })
    validation: Dataset({
        features: ['image'],
        num_rows: 100000
    })
})
ViTModel(
  (embeddings): ViTEmbeddings(
    (patch_embeddings): ViTPatchEmbeddings(
      (projection): Conv2d(3, 1024, kernel_size=(16, 16), stride=(16, 16))
    )
    (dropout): Dropout(p=0.0, inplace=False)
  )
  (encoder): ViTEncoder(
    (layer): ModuleList(
      (0-23): 24 x ViTLayer(
        (attention): ViTAttention(
          (attention): ViTSelfAttention(
            (query): Linear(in_features=1024, out_features=1024, bias=True)
            (key): Linear(in_features=1024, out_features=1024, bias=True)
            (value): Linear(in_features=1024, out_features=1024, bias=True)
            (dropout): Dropout(p=0.0, inplace=False)
          )
          (output): ViTSelfOutput(
            (dense): Linear(in_features=1024, out_features=1024, bias=True)
            (dropout): Dropout(p=0.0, inplace=False)
          )
        )
        (intermediate): ViTIntermediate(
          (dense): Linear(in_features=1024, out_features=4096, bias=True)
          (intermediate_act_fn): GELUActivation()
        )
        (output): ViTOutput(
          (dense): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.0, inplace=False)
        )
        (layernorm_before): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
        (layernorm_after): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
      )
    )
  )
  (layernorm): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
  (pooler): GGeM()
)
query_embeddings tensor([[0.8288, 0.4748, 0.4443,  ..., 0.1754, 0.6903, 0.5322],
        [0.8635, 0.3330, 0.1886,  ..., 0.1827, 0.5924, 0.4528],
        [1.2988, 0.5212, 0.1786,  ..., 0.4126, 0.7994, 0.3201],
        ...,
        [0.5587, 0.1440, 0.2082,  ..., 0.2209, 0.4171, 0.6497],
        [0.3240, 0.2724, 0.2524,  ..., 0.3896, 0.5229, 1.1410],
        [1.2459, 0.7144, 0.2072,  ..., 0.0748, 0.4475, 0.6637]],
       device='cuda:0', dtype=torch.float64)
torch.Size([1024])
Computing norms:   0%|          | 0/1129 [00:00<?, ?it/s]Computing norms:   1%|          | 7/1129 [00:00<00:17, 62.98it/s]Computing norms:   1%|          | 14/1129 [00:00<00:17, 64.96it/s]Computing norms:   2%|▏         | 21/1129 [00:00<00:16, 65.39it/s]Computing norms:   2%|▏         | 28/1129 [00:00<00:16, 65.71it/s]Computing norms:   3%|▎         | 35/1129 [00:00<00:17, 63.97it/s]Computing norms:   4%|▎         | 42/1129 [00:00<00:17, 62.89it/s]Computing norms:   4%|▍         | 49/1129 [00:00<00:17, 62.36it/s]Computing norms:   5%|▍         | 56/1129 [00:00<00:17, 61.91it/s]Computing norms:   6%|▌         | 63/1129 [00:01<00:17, 61.60it/s]Computing norms:   6%|▌         | 70/1129 [00:01<00:17, 61.41it/s]Computing norms:   7%|▋         | 77/1129 [00:01<00:17, 61.22it/s]Computing norms:   7%|▋         | 84/1129 [00:01<00:17, 61.29it/s]Computing norms:   8%|▊         | 91/1129 [00:01<00:16, 61.33it/s]Computing norms:   9%|▊         | 98/1129 [00:01<00:16, 61.28it/s]Computing norms:   9%|▉         | 105/1129 [00:01<00:16, 61.24it/s]Computing norms:  10%|▉         | 112/1129 [00:01<00:16, 61.20it/s]Computing norms:  11%|█         | 119/1129 [00:01<00:16, 61.23it/s]Computing norms:  11%|█         | 126/1129 [00:02<00:16, 61.18it/s]Computing norms:  12%|█▏        | 133/1129 [00:02<00:16, 61.19it/s]Computing norms:  12%|█▏        | 140/1129 [00:02<00:16, 61.15it/s]Computing norms:  13%|█▎        | 147/1129 [00:02<00:16, 61.27it/s]Computing norms:  14%|█▎        | 154/1129 [00:02<00:15, 61.14it/s]Computing norms:  14%|█▍        | 161/1129 [00:02<00:15, 60.94it/s]Computing norms:  15%|█▍        | 168/1129 [00:02<00:15, 61.08it/s]Computing norms:  16%|█▌        | 175/1129 [00:02<00:15, 61.15it/s]Computing norms:  16%|█▌        | 182/1129 [00:02<00:15, 61.11it/s]Computing norms:  17%|█▋        | 189/1129 [00:03<00:15, 61.16it/s]Computing norms:  17%|█▋        | 196/1129 [00:03<00:15, 61.08it/s]Computing norms:  18%|█▊        | 203/1129 [00:03<00:15, 61.30it/s]Computing norms:  19%|█▊        | 210/1129 [00:03<00:14, 61.43it/s]Computing norms:  19%|█▉        | 217/1129 [00:03<00:14, 61.33it/s]Computing norms:  20%|█▉        | 224/1129 [00:03<00:14, 61.29it/s]Computing norms:  20%|██        | 231/1129 [00:03<00:14, 61.27it/s]Computing norms:  21%|██        | 238/1129 [00:03<00:14, 61.25it/s]Computing norms:  22%|██▏       | 245/1129 [00:03<00:14, 61.11it/s]Computing norms:  22%|██▏       | 252/1129 [00:04<00:14, 61.14it/s]Computing norms:  23%|██▎       | 259/1129 [00:04<00:14, 61.19it/s]Computing norms:  24%|██▎       | 266/1129 [00:04<00:14, 61.27it/s]Computing norms:  24%|██▍       | 273/1129 [00:04<00:14, 61.08it/s]Computing norms:  25%|██▍       | 280/1129 [00:04<00:13, 61.07it/s]Computing norms:  25%|██▌       | 287/1129 [00:04<00:13, 61.36it/s]Computing norms:  26%|██▌       | 294/1129 [00:04<00:13, 61.34it/s]Computing norms:  27%|██▋       | 301/1129 [00:04<00:13, 61.44it/s]Computing norms:  27%|██▋       | 308/1129 [00:05<00:13, 61.15it/s]Computing norms:  28%|██▊       | 315/1129 [00:05<00:13, 60.53it/s]Computing norms:  29%|██▊       | 322/1129 [00:05<00:13, 60.01it/s]Computing norms:  29%|██▉       | 329/1129 [00:05<00:13, 59.57it/s]Computing norms:  30%|██▉       | 335/1129 [00:05<00:13, 59.54it/s]Computing norms:  30%|███       | 341/1129 [00:05<00:13, 59.42it/s]Computing norms:  31%|███       | 347/1129 [00:05<00:13, 59.23it/s]Computing norms:  31%|███▏      | 353/1129 [00:05<00:13, 59.14it/s]Computing norms:  32%|███▏      | 359/1129 [00:05<00:13, 59.19it/s]Computing norms:  32%|███▏      | 365/1129 [00:05<00:12, 59.30it/s]Computing norms:  33%|███▎      | 371/1129 [00:06<00:12, 59.40it/s]Computing norms:  33%|███▎      | 378/1129 [00:06<00:12, 59.65it/s]Computing norms:  34%|███▍      | 384/1129 [00:06<00:12, 59.70it/s]Computing norms:  35%|███▍      | 391/1129 [00:06<00:12, 59.93it/s]Computing norms:  35%|███▌      | 398/1129 [00:06<00:12, 59.84it/s]Computing norms:  36%|███▌      | 405/1129 [00:06<00:12, 59.96it/s]Computing norms:  36%|███▋      | 411/1129 [00:06<00:12, 59.83it/s]Computing norms:  37%|███▋      | 418/1129 [00:06<00:11, 59.96it/s]Computing norms:  38%|███▊      | 425/1129 [00:06<00:11, 60.39it/s]Computing norms:  38%|███▊      | 432/1129 [00:07<00:11, 60.38it/s]Computing norms:  39%|███▉      | 439/1129 [00:07<00:11, 59.66it/s]Computing norms:  39%|███▉      | 445/1129 [00:07<00:11, 59.49it/s]Computing norms:  40%|████      | 452/1129 [00:07<00:11, 59.76it/s]Computing norms:  41%|████      | 458/1129 [00:07<00:11, 59.33it/s]Computing norms:  41%|████      | 464/1129 [00:07<00:11, 59.25it/s]Computing norms:  42%|████▏     | 470/1129 [00:07<00:11, 59.28it/s]Computing norms:  42%|████▏     | 477/1129 [00:07<00:10, 59.61it/s]Computing norms:  43%|████▎     | 483/1129 [00:07<00:10, 59.35it/s]Computing norms:  43%|████▎     | 489/1129 [00:08<00:10, 59.10it/s]Computing norms:  44%|████▍     | 495/1129 [00:08<00:10, 59.15it/s]Computing norms:  44%|████▍     | 501/1129 [00:08<00:10, 59.26it/s]Computing norms:  45%|████▍     | 507/1129 [00:08<00:10, 59.46it/s]Computing norms:  45%|████▌     | 513/1129 [00:08<00:10, 59.49it/s]Computing norms:  46%|████▌     | 519/1129 [00:08<00:10, 59.41it/s]Computing norms:  47%|████▋     | 526/1129 [00:08<00:10, 59.74it/s]Computing norms:  47%|████▋     | 533/1129 [00:08<00:09, 59.79it/s]Computing norms:  48%|████▊     | 539/1129 [00:08<00:09, 59.43it/s]Computing norms:  48%|████▊     | 545/1129 [00:08<00:09, 59.39it/s]Computing norms:  49%|████▉     | 551/1129 [00:09<00:09, 59.53it/s]Computing norms:  49%|████▉     | 557/1129 [00:09<00:09, 59.56it/s]Computing norms:  50%|████▉     | 564/1129 [00:09<00:09, 59.92it/s]Computing norms:  50%|█████     | 570/1129 [00:09<00:09, 59.94it/s]Computing norms:  51%|█████     | 576/1129 [00:09<00:09, 59.93it/s]Computing norms:  52%|█████▏    | 583/1129 [00:09<00:09, 60.14it/s]Computing norms:  52%|█████▏    | 590/1129 [00:09<00:08, 60.32it/s]Computing norms:  53%|█████▎    | 597/1129 [00:09<00:08, 60.20it/s]Computing norms:  53%|█████▎    | 604/1129 [00:09<00:08, 60.25it/s]Computing norms:  54%|█████▍    | 611/1129 [00:10<00:08, 60.30it/s]Computing norms:  55%|█████▍    | 618/1129 [00:10<00:08, 60.19it/s]Computing norms:  55%|█████▌    | 625/1129 [00:10<00:08, 60.06it/s]Computing norms:  56%|█████▌    | 632/1129 [00:10<00:08, 59.92it/s]Computing norms:  57%|█████▋    | 638/1129 [00:10<00:08, 59.77it/s]Computing norms:  57%|█████▋    | 644/1129 [00:10<00:08, 59.80it/s]Computing norms:  58%|█████▊    | 651/1129 [00:10<00:07, 59.89it/s]Computing norms:  58%|█████▊    | 657/1129 [00:10<00:07, 59.82it/s]Computing norms:  59%|█████▉    | 664/1129 [00:10<00:07, 60.00it/s]Computing norms:  59%|█████▉    | 670/1129 [00:11<00:07, 59.79it/s]Computing norms:  60%|█████▉    | 676/1129 [00:11<00:07, 59.71it/s]Computing norms:  60%|██████    | 682/1129 [00:11<00:07, 59.79it/s]Computing norms:  61%|██████    | 689/1129 [00:11<00:07, 59.89it/s]Computing norms:  62%|██████▏   | 695/1129 [00:11<00:07, 59.74it/s]Computing norms:  62%|██████▏   | 701/1129 [00:11<00:07, 59.76it/s]Computing norms:  63%|██████▎   | 707/1129 [00:11<00:07, 59.76it/s]Computing norms:  63%|██████▎   | 713/1129 [00:11<00:06, 59.72it/s]Computing norms:  64%|██████▎   | 719/1129 [00:11<00:06, 59.78it/s]Computing norms:  64%|██████▍   | 725/1129 [00:11<00:06, 59.77it/s]Computing norms:  65%|██████▍   | 731/1129 [00:12<00:06, 59.83it/s]Computing norms:  65%|██████▌   | 737/1129 [00:12<00:06, 59.67it/s]Computing norms:  66%|██████▌   | 743/1129 [00:12<00:06, 59.70it/s]Computing norms:  66%|██████▋   | 749/1129 [00:12<00:06, 59.61it/s]Computing norms:  67%|██████▋   | 755/1129 [00:13<00:21, 17.41it/s]Computing norms:  67%|██████▋   | 762/1129 [00:13<00:16, 22.84it/s]Computing norms:  68%|██████▊   | 768/1129 [00:13<00:12, 27.83it/s]Computing norms:  69%|██████▊   | 774/1129 [00:13<00:10, 32.99it/s]Computing norms:  69%|██████▉   | 781/1129 [00:13<00:08, 38.72it/s]Computing norms:  70%|██████▉   | 788/1129 [00:13<00:07, 43.75it/s]Computing norms:  70%|███████   | 795/1129 [00:13<00:06, 47.83it/s]Computing norms:  71%|███████   | 802/1129 [00:14<00:06, 51.19it/s]Computing norms:  72%|███████▏  | 809/1129 [00:14<00:05, 53.72it/s]Computing norms:  72%|███████▏  | 816/1129 [00:14<00:05, 55.74it/s]Computing norms:  73%|███████▎  | 823/1129 [00:14<00:05, 57.03it/s]Computing norms:  74%|███████▎  | 830/1129 [00:14<00:05, 58.11it/s]Computing norms:  74%|███████▍  | 837/1129 [00:14<00:04, 58.71it/s]Computing norms:  75%|███████▍  | 844/1129 [00:14<00:04, 59.32it/s]Computing norms:  75%|███████▌  | 851/1129 [00:14<00:04, 59.51it/s]Computing norms:  76%|███████▌  | 858/1129 [00:15<00:04, 59.47it/s]Computing norms:  77%|███████▋  | 864/1129 [00:15<00:04, 59.53it/s]Computing norms:  77%|███████▋  | 871/1129 [00:15<00:04, 59.79it/s]Computing norms:  78%|███████▊  | 878/1129 [00:15<00:04, 59.73it/s]Computing norms:  78%|███████▊  | 884/1129 [00:15<00:04, 59.41it/s]Computing norms:  79%|███████▉  | 890/1129 [00:15<00:04, 59.18it/s]Computing norms:  79%|███████▉  | 897/1129 [00:15<00:03, 59.54it/s]Computing norms:  80%|███████▉  | 903/1129 [00:15<00:03, 59.37it/s]Computing norms:  81%|████████  | 909/1129 [00:15<00:03, 59.29it/s]Computing norms:  81%|████████  | 916/1129 [00:15<00:03, 59.60it/s]Computing norms:  82%|████████▏ | 922/1129 [00:16<00:03, 59.35it/s]Computing norms:  82%|████████▏ | 929/1129 [00:16<00:03, 59.71it/s]Computing norms:  83%|████████▎ | 935/1129 [00:16<00:03, 59.55it/s]Computing norms:  83%|████████▎ | 941/1129 [00:16<00:03, 59.67it/s]Computing norms:  84%|████████▍ | 947/1129 [00:16<00:03, 59.72it/s]Computing norms:  84%|████████▍ | 953/1129 [00:16<00:02, 59.66it/s]Computing norms:  85%|████████▌ | 960/1129 [00:16<00:02, 59.89it/s]Computing norms:  86%|████████▌ | 966/1129 [00:16<00:02, 59.54it/s]Computing norms:  86%|████████▌ | 972/1129 [00:16<00:02, 59.42it/s]Computing norms:  87%|████████▋ | 978/1129 [00:17<00:02, 59.59it/s]Computing norms:  87%|████████▋ | 984/1129 [00:17<00:02, 59.61it/s]Computing norms:  88%|████████▊ | 990/1129 [00:17<00:02, 59.72it/s]Computing norms:  88%|████████▊ | 996/1129 [00:17<00:02, 59.41it/s]Computing norms:  89%|████████▉ | 1003/1129 [00:17<00:02, 59.67it/s]Computing norms:  89%|████████▉ | 1009/1129 [00:17<00:02, 59.44it/s]Computing norms:  90%|████████▉ | 1015/1129 [00:17<00:01, 58.81it/s]Computing norms:  90%|█████████ | 1021/1129 [00:17<00:01, 59.11it/s]Computing norms:  91%|█████████ | 1027/1129 [00:17<00:01, 59.20it/s]Computing norms:  91%|█████████▏| 1033/1129 [00:17<00:01, 58.96it/s]Computing norms:  92%|█████████▏| 1039/1129 [00:18<00:01, 59.10it/s]Computing norms:  93%|█████████▎| 1045/1129 [00:18<00:01, 59.35it/s]Computing norms:  93%|█████████▎| 1051/1129 [00:18<00:01, 59.33it/s]Computing norms:  94%|█████████▎| 1057/1129 [00:18<00:01, 59.30it/s]Computing norms:  94%|█████████▍| 1063/1129 [00:18<00:01, 59.37it/s]Computing norms:  95%|█████████▍| 1069/1129 [00:18<00:01, 59.51it/s]Computing norms:  95%|█████████▌| 1076/1129 [00:18<00:00, 59.83it/s]Computing norms:  96%|█████████▌| 1083/1129 [00:18<00:00, 60.01it/s]Computing norms:  97%|█████████▋| 1090/1129 [00:18<00:00, 60.19it/s]Computing norms:  97%|█████████▋| 1097/1129 [00:19<00:00, 60.20it/s]Computing norms:  98%|█████████▊| 1104/1129 [00:19<00:00, 60.25it/s]Computing norms:  98%|█████████▊| 1111/1129 [00:19<00:00, 60.28it/s]Computing norms:  99%|█████████▉| 1118/1129 [00:19<00:00, 60.28it/s]Computing norms: 100%|█████████▉| 1125/1129 [00:19<00:00, 60.14it/s]Computing norms: 100%|██████████| 1129/1129 [00:19<00:00, 57.71it/s]
Loading cached processed dataset at /scratch/lustre/home/auma4493/.cache/huggingface/datasets/imagefolder/glv2-next-final-f1222a0f34855ac2/0.0.0/37fbb85cc714a338bea574ac6c7d0b5be5aff46c1862c1989b20e0771199e93f/cache-15d5e06a6ae005c3.arrow
torch.Size([1024])
Computing matrix:   0%|          | 0/1129 [00:00<?, ?it/s]Computing matrix:   5%|▌         | 62/1129 [00:00<00:01, 611.34it/s]Computing matrix:  11%|█         | 124/1129 [00:00<00:01, 612.06it/s]Computing matrix:  16%|█▋        | 186/1129 [00:00<00:01, 612.66it/s]Computing matrix:  22%|██▏       | 248/1129 [00:00<00:01, 613.33it/s]Computing matrix:  27%|██▋       | 310/1129 [00:00<00:01, 613.60it/s]Computing matrix:  33%|███▎      | 372/1129 [00:00<00:01, 605.85it/s]Computing matrix:  38%|███▊      | 433/1129 [00:00<00:01, 594.99it/s]Computing matrix:  44%|████▎     | 493/1129 [00:00<00:01, 588.83it/s]Computing matrix:  49%|████▉     | 552/1129 [00:00<00:00, 584.43it/s]Computing matrix:  54%|█████▍    | 611/1129 [00:01<00:00, 581.48it/s]Computing matrix:  59%|█████▉    | 670/1129 [00:01<00:00, 579.97it/s]Computing matrix:  65%|██████▍   | 729/1129 [00:01<00:00, 578.96it/s]Computing matrix:  70%|██████▉   | 787/1129 [00:01<00:00, 484.47it/s]Computing matrix:  75%|███████▍  | 845/1129 [00:01<00:00, 508.61it/s]Computing matrix:  80%|███████▉  | 903/1129 [00:01<00:00, 527.16it/s]Computing matrix:  85%|████████▌ | 961/1129 [00:01<00:00, 541.07it/s]Computing matrix:  90%|█████████ | 1019/1129 [00:01<00:00, 551.41it/s]Computing matrix:  95%|█████████▌| 1077/1129 [00:01<00:00, 558.79it/s]Computing matrix: 100%|██████████| 1129/1129 [00:01<00:00, 567.36it/s]
[[0.85485438 0.81818551 0.84428629 ... 0.82615946 0.85974691 0.86334714]
 [0.86700994 0.79460614 0.83051849 ... 0.84538292 0.81992707 0.85587934]
 [0.85313724 0.81502175 0.86879759 ... 0.85512276 0.85349407 0.85201437]
 ...
 [0.84987454 0.84123709 0.87253824 ... 0.82611659 0.85731627 0.85812307]
 [0.82840518 0.79893912 0.83657925 ... 0.80496449 0.87160093 0.83169799]
 [0.84329085 0.82572809 0.8562431  ... 0.82902249 0.86672796 0.84875653]]
(1129, 10000)
[[ 0.01017943 -0.02648944 -0.00038866 ... -0.01851549  0.01507196
   0.01867218]
 [ 0.03550122 -0.03690258 -0.00099023 ...  0.01387419 -0.01158165
   0.02437062]
 [ 0.01005167 -0.02806382  0.02571203 ...  0.0120372   0.01040851
   0.0089288 ]
 ...
 [ 0.00452813 -0.00410932  0.02719183 ... -0.01922982  0.01196985
   0.01277666]
 [-0.00869137 -0.03815742 -0.0005173  ... -0.03213206  0.03450438
  -0.00539856]
 [ 0.00134798 -0.01621479  0.01430022 ... -0.01292039  0.02478508
   0.00681366]]
(1129, 10000)
