/scratch/lustre/home/auma4493/TheNextModel/FinalEvaluation
args: Namespace(batch_size=32, dataset='glv2_t', model_checkpoint='/scratch/lustre/home/auma4493/TheNextModel/FinalTraining/checkpoints/disc/trained_model_17_20.pth', model_name='google/vit-large-patch16-224', model_type='disc', use_GeM=True)
Resolving data files:   0%|          | 0/138520 [00:00<?, ?it/s]Resolving data files:  18%|█▊        | 25455/138520 [00:00<00:00, 254505.95it/s]Resolving data files:  37%|███▋      | 50906/138520 [00:00<00:00, 196413.00it/s]Resolving data files:  52%|█████▏    | 71348/138520 [00:00<00:00, 183551.98it/s]Resolving data files:  66%|██████▌   | 91394/138520 [00:00<00:00, 180755.71it/s]Resolving data files:  79%|███████▉  | 109689/138520 [00:00<00:00, 178093.20it/s]Resolving data files:  96%|█████████▌| 132431/138520 [00:00<00:00, 193278.88it/s]Resolving data files: 100%|██████████| 138520/138520 [00:01<00:00, 102533.61it/s]
Resolving data files:   0%|          | 0/1129 [00:00<?, ?it/s]Resolving data files: 100%|██████████| 1129/1129 [00:00<00:00, 21307.46it/s]
Resolving data files:   0%|          | 0/10000 [00:00<?, ?it/s]Resolving data files:  50%|█████     | 5018/10000 [00:00<00:00, 45624.75it/s]Resolving data files:  96%|█████████▌| 9581/10000 [00:00<00:00, 13338.86it/s]Resolving data files: 100%|██████████| 10000/10000 [00:00<00:00, 15497.82it/s]
Found cached dataset imagefolder (/scratch/lustre/home/auma4493/.cache/huggingface/datasets/imagefolder/glv2-next-final-f1222a0f34855ac2/0.0.0/37fbb85cc714a338bea574ac6c7d0b5be5aff46c1862c1989b20e0771199e93f)
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:00<00:01,  1.53it/s] 67%|██████▋   | 2/3 [00:01<00:00,  1.54it/s]100%|██████████| 3/3 [00:01<00:00,  1.57it/s]100%|██████████| 3/3 [00:01<00:00,  1.56it/s]
main dataset:  DatasetDict({
    train: Dataset({
        features: ['image'],
        num_rows: 138520
    })
    test: Dataset({
        features: ['image'],
        num_rows: 1129
    })
    validation: Dataset({
        features: ['image'],
        num_rows: 10000
    })
})
Resolving data files:   0%|          | 0/100000 [00:00<?, ?it/s]Resolving data files:  28%|██▊       | 27536/100000 [00:00<00:00, 275332.69it/s]Resolving data files:  59%|█████▉    | 58989/100000 [00:00<00:00, 298380.79it/s]Resolving data files:  89%|████████▉ | 88828/100000 [00:00<00:00, 255063.40it/s]Resolving data files: 100%|██████████| 100000/100000 [00:01<00:00, 84441.40it/s]
Resolving data files:   0%|          | 0/10000 [00:00<?, ?it/s]Resolving data files:  61%|██████    | 6067/10000 [00:00<00:00, 59834.24it/s]Resolving data files: 100%|██████████| 10000/10000 [00:00<00:00, 10772.91it/s]
Resolving data files:   0%|          | 0/100000 [00:00<?, ?it/s]Resolving data files:  19%|█▊        | 18558/100000 [00:00<00:00, 181025.51it/s]Resolving data files:  38%|███▊      | 38311/100000 [00:00<00:00, 173580.78it/s]Resolving data files:  57%|█████▋    | 56646/100000 [00:00<00:00, 177786.34it/s]Resolving data files:  82%|████████▏ | 81546/100000 [00:00<00:00, 204918.71it/s]Resolving data files: 100%|██████████| 100000/100000 [00:02<00:00, 48608.43it/s]
Found cached dataset imagefolder (/scratch/lustre/home/auma4493/.cache/huggingface/datasets/imagefolder/disc21-next-final-453d375012a0d071/0.0.0/37fbb85cc714a338bea574ac6c7d0b5be5aff46c1862c1989b20e0771199e93f)
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:00<00:01,  1.05it/s] 67%|██████▋   | 2/3 [00:01<00:00,  1.07it/s]100%|██████████| 3/3 [00:02<00:00,  1.07it/s]100%|██████████| 3/3 [00:02<00:00,  1.07it/s]
Some weights of the model checkpoint at google/vit-large-patch16-224 were not used when initializing ViTModel: ['classifier.bias', 'classifier.weight']
- This IS expected if you are initializing ViTModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ViTModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ViTModel were not initialized from the model checkpoint at google/vit-large-patch16-224 and are newly initialized: ['vit.pooler.dense.weight', 'vit.pooler.dense.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
train dataset:  DatasetDict({
    train: Dataset({
        features: ['image'],
        num_rows: 100000
    })
    test: Dataset({
        features: ['image'],
        num_rows: 10000
    })
    validation: Dataset({
        features: ['image'],
        num_rows: 100000
    })
})
ViTModel(
  (embeddings): ViTEmbeddings(
    (patch_embeddings): ViTPatchEmbeddings(
      (projection): Conv2d(3, 1024, kernel_size=(16, 16), stride=(16, 16))
    )
    (dropout): Dropout(p=0.0, inplace=False)
  )
  (encoder): ViTEncoder(
    (layer): ModuleList(
      (0-23): 24 x ViTLayer(
        (attention): ViTAttention(
          (attention): ViTSelfAttention(
            (query): Linear(in_features=1024, out_features=1024, bias=True)
            (key): Linear(in_features=1024, out_features=1024, bias=True)
            (value): Linear(in_features=1024, out_features=1024, bias=True)
            (dropout): Dropout(p=0.0, inplace=False)
          )
          (output): ViTSelfOutput(
            (dense): Linear(in_features=1024, out_features=1024, bias=True)
            (dropout): Dropout(p=0.0, inplace=False)
          )
        )
        (intermediate): ViTIntermediate(
          (dense): Linear(in_features=1024, out_features=4096, bias=True)
          (intermediate_act_fn): GELUActivation()
        )
        (output): ViTOutput(
          (dense): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.0, inplace=False)
        )
        (layernorm_before): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
        (layernorm_after): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
      )
    )
  )
  (layernorm): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
  (pooler): GGeM()
)
Map:   0%|          | 0/1129 [00:00<?, ? examples/s]Map:   3%|▎         | 32/1129 [00:08<05:00,  3.64 examples/s]Map:   6%|▌         | 64/1129 [00:10<02:24,  7.38 examples/s]Map:   9%|▊         | 96/1129 [00:10<01:25, 12.15 examples/s]Map:  11%|█▏        | 128/1129 [00:11<00:57, 17.40 examples/s]Map:  14%|█▍        | 160/1129 [00:11<00:42, 22.87 examples/s]Map:  17%|█▋        | 192/1129 [00:12<00:33, 28.26 examples/s]Map:  20%|█▉        | 224/1129 [00:13<00:27, 33.33 examples/s]Map:  23%|██▎       | 256/1129 [00:13<00:23, 37.61 examples/s]Map:  26%|██▌       | 288/1129 [00:14<00:20, 41.18 examples/s]Map:  28%|██▊       | 320/1129 [00:14<00:18, 43.92 examples/s]Map:  31%|███       | 352/1129 [00:15<00:16, 46.03 examples/s]Map:  34%|███▍      | 384/1129 [00:16<00:15, 47.37 examples/s]Map:  37%|███▋      | 416/1129 [00:16<00:14, 48.64 examples/s]Map:  40%|███▉      | 448/1129 [00:17<00:14, 48.24 examples/s]Map:  43%|████▎     | 480/1129 [00:18<00:17, 36.79 examples/s]Map:  45%|████▌     | 512/1129 [00:20<00:19, 31.83 examples/s]Map:  48%|████▊     | 544/1129 [00:21<00:21, 27.79 examples/s]Map:  51%|█████     | 576/1129 [00:22<00:19, 28.22 examples/s]Map:  54%|█████▍    | 608/1129 [00:23<00:16, 32.28 examples/s]Map:  57%|█████▋    | 640/1129 [00:25<00:18, 26.13 examples/s]Map:  60%|█████▉    | 672/1129 [00:26<00:18, 24.56 examples/s]Map:  62%|██████▏   | 704/1129 [00:28<00:19, 21.40 examples/s]Map:  65%|██████▌   | 736/1129 [00:29<00:16, 24.55 examples/s]Map:  68%|██████▊   | 768/1129 [00:30<00:14, 24.36 examples/s]Map:  71%|███████   | 800/1129 [00:31<00:11, 27.44 examples/s]Map:  74%|███████▎  | 832/1129 [00:32<00:10, 27.24 examples/s]Map:  77%|███████▋  | 864/1129 [00:34<00:10, 25.10 examples/s]Map:  79%|███████▉  | 896/1129 [00:35<00:09, 24.50 examples/s]Map:  82%|████████▏ | 928/1129 [00:37<00:08, 22.93 examples/s]Map:  85%|████████▌ | 960/1129 [00:38<00:06, 26.65 examples/s]Map:  88%|████████▊ | 992/1129 [00:39<00:05, 25.82 examples/s]Map:  91%|█████████ | 1024/1129 [00:40<00:04, 25.76 examples/s]Map:  94%|█████████▎| 1056/1129 [00:41<00:02, 28.33 examples/s]Map:  96%|█████████▋| 1088/1129 [00:42<00:01, 26.47 examples/s]Map:  99%|█████████▉| 1120/1129 [00:44<00:00, 26.57 examples/s]Map: 100%|██████████| 1129/1129 [00:44<00:00, 26.21 examples/s]                                                               Loading cached processed dataset at /scratch/lustre/home/auma4493/.cache/huggingface/datasets/imagefolder/disc21-next-final-453d375012a0d071/0.0.0/37fbb85cc714a338bea574ac6c7d0b5be5aff46c1862c1989b20e0771199e93f/cache-656b75c6367eade0.arrow
query_embeddings tensor([[0.6882, 0.6443, 0.2244,  ..., 0.4143, 0.8875, 0.3617],
        [1.0342, 0.6698, 0.1535,  ..., 0.3382, 0.8221, 0.2979],
        [0.9185, 0.7405, 0.0795,  ..., 0.3709, 1.1643, 0.2470],
        ...,
        [0.3052, 0.5138, 0.0789,  ..., 0.2745, 0.7534, 0.4162],
        [0.1975, 0.5135, 0.0445,  ..., 0.4530, 0.4191, 0.8250],
        [0.9291, 1.0251, 0.0542,  ..., 0.1757, 0.5921, 0.2239]],
       device='cuda:0', dtype=torch.float64)
torch.Size([1024])
Computing norms:   0%|          | 0/1129 [00:00<?, ?it/s]Computing norms:   1%|          | 7/1129 [00:00<00:17, 63.59it/s]Computing norms:   1%|          | 14/1129 [00:00<00:17, 64.64it/s]Computing norms:   2%|▏         | 21/1129 [00:00<00:16, 65.21it/s]Computing norms:   2%|▏         | 28/1129 [00:00<00:16, 64.86it/s]Computing norms:   3%|▎         | 35/1129 [00:00<00:17, 63.27it/s]Computing norms:   4%|▎         | 42/1129 [00:00<00:17, 62.18it/s]Computing norms:   4%|▍         | 49/1129 [00:00<00:17, 61.58it/s]Computing norms:   5%|▍         | 56/1129 [00:00<00:17, 61.22it/s]Computing norms:   6%|▌         | 63/1129 [00:01<00:17, 60.87it/s]Computing norms:   6%|▌         | 70/1129 [00:01<00:17, 60.76it/s]Computing norms:   7%|▋         | 77/1129 [00:01<00:17, 60.64it/s]Computing norms:   7%|▋         | 84/1129 [00:01<00:17, 60.20it/s]Computing norms:   8%|▊         | 91/1129 [00:01<00:17, 59.97it/s]Computing norms:   9%|▊         | 97/1129 [00:01<00:17, 59.94it/s]Computing norms:   9%|▉         | 103/1129 [00:01<00:17, 59.94it/s]Computing norms:  10%|▉         | 110/1129 [00:01<00:16, 60.21it/s]Computing norms:  10%|█         | 117/1129 [00:01<00:16, 60.18it/s]Computing norms:  11%|█         | 124/1129 [00:02<00:16, 60.23it/s]Computing norms:  12%|█▏        | 131/1129 [00:02<00:16, 60.23it/s]Computing norms:  12%|█▏        | 138/1129 [00:02<00:16, 60.18it/s]Computing norms:  13%|█▎        | 145/1129 [00:02<00:16, 60.31it/s]Computing norms:  13%|█▎        | 152/1129 [00:02<00:16, 60.26it/s]Computing norms:  14%|█▍        | 159/1129 [00:02<00:16, 60.18it/s]Computing norms:  15%|█▍        | 166/1129 [00:02<00:16, 60.18it/s]Computing norms:  15%|█▌        | 173/1129 [00:02<00:15, 60.13it/s]Computing norms:  16%|█▌        | 180/1129 [00:02<00:15, 60.20it/s]Computing norms:  17%|█▋        | 187/1129 [00:03<00:15, 60.22it/s]Computing norms:  17%|█▋        | 194/1129 [00:03<00:15, 59.84it/s]Computing norms:  18%|█▊        | 200/1129 [00:03<00:15, 59.75it/s]Computing norms:  18%|█▊        | 206/1129 [00:03<00:15, 59.81it/s]Computing norms:  19%|█▉        | 212/1129 [00:03<00:15, 59.84it/s]Computing norms:  19%|█▉        | 219/1129 [00:03<00:15, 60.02it/s]Computing norms:  20%|██        | 226/1129 [00:03<00:15, 59.98it/s]Computing norms:  21%|██        | 233/1129 [00:03<00:14, 60.04it/s]Computing norms:  21%|██▏       | 240/1129 [00:03<00:14, 60.07it/s]Computing norms:  22%|██▏       | 247/1129 [00:04<00:14, 60.11it/s]Computing norms:  22%|██▏       | 254/1129 [00:04<00:14, 60.12it/s]Computing norms:  23%|██▎       | 261/1129 [00:04<00:14, 60.30it/s]Computing norms:  24%|██▎       | 268/1129 [00:04<00:14, 60.31it/s]Computing norms:  24%|██▍       | 275/1129 [00:04<00:14, 60.30it/s]Computing norms:  25%|██▍       | 282/1129 [00:04<00:14, 60.29it/s]Computing norms:  26%|██▌       | 289/1129 [00:04<00:13, 60.27it/s]Computing norms:  26%|██▌       | 296/1129 [00:04<00:13, 60.27it/s]Computing norms:  27%|██▋       | 303/1129 [00:05<00:13, 60.17it/s]Computing norms:  27%|██▋       | 310/1129 [00:05<00:13, 60.17it/s]Computing norms:  28%|██▊       | 317/1129 [00:05<00:13, 60.20it/s]Computing norms:  29%|██▊       | 324/1129 [00:05<00:13, 60.29it/s]Computing norms:  29%|██▉       | 331/1129 [00:05<00:13, 60.29it/s]Computing norms:  30%|██▉       | 338/1129 [00:05<00:13, 60.25it/s]Computing norms:  31%|███       | 345/1129 [00:05<00:13, 60.23it/s]Computing norms:  31%|███       | 352/1129 [00:05<00:12, 60.17it/s]Computing norms:  32%|███▏      | 359/1129 [00:05<00:12, 60.10it/s]Computing norms:  32%|███▏      | 366/1129 [00:06<00:12, 60.12it/s]Computing norms:  33%|███▎      | 373/1129 [00:06<00:12, 60.13it/s]Computing norms:  34%|███▎      | 380/1129 [00:06<00:12, 60.13it/s]Computing norms:  34%|███▍      | 387/1129 [00:06<00:12, 59.86it/s]Computing norms:  35%|███▍      | 393/1129 [00:06<00:12, 59.65it/s]Computing norms:  35%|███▌      | 400/1129 [00:06<00:12, 59.88it/s]Computing norms:  36%|███▌      | 407/1129 [00:06<00:12, 60.06it/s]Computing norms:  37%|███▋      | 414/1129 [00:06<00:11, 60.21it/s]Computing norms:  37%|███▋      | 421/1129 [00:06<00:11, 60.00it/s]Computing norms:  38%|███▊      | 427/1129 [00:07<00:11, 59.85it/s]Computing norms:  38%|███▊      | 434/1129 [00:07<00:11, 59.95it/s]Computing norms:  39%|███▉      | 441/1129 [00:07<00:11, 60.03it/s]Computing norms:  40%|███▉      | 448/1129 [00:07<00:11, 60.16it/s]Computing norms:  40%|████      | 455/1129 [00:07<00:11, 60.24it/s]Computing norms:  41%|████      | 462/1129 [00:07<00:11, 60.26it/s]Computing norms:  42%|████▏     | 469/1129 [00:07<00:10, 60.28it/s]Computing norms:  42%|████▏     | 476/1129 [00:07<00:10, 60.14it/s]Computing norms:  43%|████▎     | 483/1129 [00:08<00:10, 59.97it/s]Computing norms:  43%|████▎     | 489/1129 [00:08<00:10, 59.95it/s]Computing norms:  44%|████▍     | 496/1129 [00:08<00:10, 60.03it/s]Computing norms:  45%|████▍     | 503/1129 [00:08<00:10, 59.61it/s]Computing norms:  45%|████▌     | 510/1129 [00:08<00:10, 59.86it/s]Computing norms:  46%|████▌     | 517/1129 [00:08<00:10, 59.98it/s]Computing norms:  46%|████▋     | 524/1129 [00:08<00:10, 60.10it/s]Computing norms:  47%|████▋     | 531/1129 [00:08<00:09, 60.23it/s]Computing norms:  48%|████▊     | 538/1129 [00:08<00:09, 60.29it/s]Computing norms:  48%|████▊     | 545/1129 [00:09<00:09, 60.36it/s]Computing norms:  49%|████▉     | 552/1129 [00:09<00:09, 60.38it/s]Computing norms:  50%|████▉     | 559/1129 [00:09<00:09, 60.29it/s]Computing norms:  50%|█████     | 566/1129 [00:09<00:09, 60.04it/s]Computing norms:  51%|█████     | 573/1129 [00:09<00:09, 60.00it/s]Computing norms:  51%|█████▏    | 579/1129 [00:09<00:09, 59.93it/s]Computing norms:  52%|█████▏    | 585/1129 [00:09<00:09, 59.91it/s]Computing norms:  52%|█████▏    | 591/1129 [00:09<00:08, 59.87it/s]Computing norms:  53%|█████▎    | 597/1129 [00:09<00:08, 59.84it/s]Computing norms:  53%|█████▎    | 603/1129 [00:10<00:08, 59.85it/s]Computing norms:  54%|█████▍    | 609/1129 [00:10<00:08, 59.82it/s]Computing norms:  54%|█████▍    | 615/1129 [00:10<00:08, 59.79it/s]Computing norms:  55%|█████▌    | 621/1129 [00:10<00:08, 59.81it/s]Computing norms:  56%|█████▌    | 628/1129 [00:10<00:08, 59.86it/s]Computing norms:  56%|█████▌    | 634/1129 [00:10<00:08, 59.72it/s]Computing norms:  57%|█████▋    | 640/1129 [00:10<00:08, 59.78it/s]Computing norms:  57%|█████▋    | 647/1129 [00:10<00:08, 59.86it/s]Computing norms:  58%|█████▊    | 653/1129 [00:10<00:07, 59.81it/s]Computing norms:  58%|█████▊    | 659/1129 [00:10<00:07, 59.81it/s]Computing norms:  59%|█████▉    | 665/1129 [00:11<00:07, 59.80it/s]Computing norms:  59%|█████▉    | 671/1129 [00:11<00:07, 59.81it/s]Computing norms:  60%|██████    | 678/1129 [00:11<00:07, 59.84it/s]Computing norms:  61%|██████    | 684/1129 [00:11<00:07, 59.53it/s]Computing norms:  61%|██████    | 690/1129 [00:11<00:07, 59.61it/s]Computing norms:  62%|██████▏   | 696/1129 [00:11<00:07, 59.67it/s]Computing norms:  62%|██████▏   | 702/1129 [00:11<00:07, 59.65it/s]Computing norms:  63%|██████▎   | 708/1129 [00:11<00:07, 59.68it/s]Computing norms:  63%|██████▎   | 714/1129 [00:11<00:07, 59.27it/s]Computing norms:  64%|██████▍   | 721/1129 [00:11<00:06, 59.62it/s]Computing norms:  64%|██████▍   | 728/1129 [00:12<00:06, 59.99it/s]Computing norms:  65%|██████▌   | 735/1129 [00:12<00:06, 60.13it/s]Computing norms:  66%|██████▌   | 742/1129 [00:13<00:19, 19.53it/s]Computing norms:  66%|██████▋   | 748/1129 [00:13<00:15, 23.93it/s]Computing norms:  67%|██████▋   | 754/1129 [00:13<00:13, 28.77it/s]Computing norms:  67%|██████▋   | 760/1129 [00:13<00:10, 33.70it/s]Computing norms:  68%|██████▊   | 766/1129 [00:13<00:09, 38.57it/s]Computing norms:  68%|██████▊   | 772/1129 [00:13<00:08, 42.97it/s]Computing norms:  69%|██████▉   | 778/1129 [00:13<00:07, 46.84it/s]Computing norms:  69%|██████▉   | 784/1129 [00:13<00:06, 50.02it/s]Computing norms:  70%|██████▉   | 790/1129 [00:13<00:06, 52.57it/s]Computing norms:  71%|███████   | 796/1129 [00:14<00:06, 54.45it/s]Computing norms:  71%|███████   | 802/1129 [00:14<00:05, 55.89it/s]Computing norms:  72%|███████▏  | 808/1129 [00:14<00:05, 56.90it/s]Computing norms:  72%|███████▏  | 814/1129 [00:14<00:05, 57.79it/s]Computing norms:  73%|███████▎  | 820/1129 [00:14<00:05, 58.41it/s]Computing norms:  73%|███████▎  | 827/1129 [00:14<00:05, 59.00it/s]Computing norms:  74%|███████▍  | 834/1129 [00:14<00:04, 59.34it/s]Computing norms:  74%|███████▍  | 841/1129 [00:14<00:04, 59.65it/s]Computing norms:  75%|███████▌  | 848/1129 [00:14<00:04, 59.81it/s]Computing norms:  76%|███████▌  | 855/1129 [00:14<00:04, 59.91it/s]Computing norms:  76%|███████▋  | 862/1129 [00:15<00:04, 60.04it/s]Computing norms:  77%|███████▋  | 869/1129 [00:15<00:04, 59.73it/s]Computing norms:  78%|███████▊  | 875/1129 [00:15<00:04, 59.80it/s]Computing norms:  78%|███████▊  | 882/1129 [00:15<00:04, 59.96it/s]Computing norms:  79%|███████▊  | 889/1129 [00:15<00:03, 60.09it/s]Computing norms:  79%|███████▉  | 896/1129 [00:15<00:03, 60.42it/s]Computing norms:  80%|███████▉  | 903/1129 [00:15<00:03, 60.31it/s]Computing norms:  81%|████████  | 910/1129 [00:15<00:03, 60.17it/s]Computing norms:  81%|████████  | 917/1129 [00:16<00:03, 60.40it/s]Computing norms:  82%|████████▏ | 924/1129 [00:16<00:03, 60.53it/s]Computing norms:  82%|████████▏ | 931/1129 [00:16<00:03, 60.53it/s]Computing norms:  83%|████████▎ | 938/1129 [00:16<00:03, 60.03it/s]Computing norms:  84%|████████▎ | 945/1129 [00:16<00:03, 60.13it/s]Computing norms:  84%|████████▍ | 952/1129 [00:16<00:02, 60.03it/s]Computing norms:  85%|████████▍ | 959/1129 [00:16<00:02, 60.06it/s]Computing norms:  86%|████████▌ | 966/1129 [00:16<00:02, 60.07it/s]Computing norms:  86%|████████▌ | 973/1129 [00:16<00:02, 60.17it/s]Computing norms:  87%|████████▋ | 980/1129 [00:17<00:02, 60.17it/s]Computing norms:  87%|████████▋ | 987/1129 [00:17<00:02, 60.24it/s]Computing norms:  88%|████████▊ | 994/1129 [00:17<00:02, 60.13it/s]Computing norms:  89%|████████▊ | 1001/1129 [00:17<00:02, 60.06it/s]Computing norms:  89%|████████▉ | 1008/1129 [00:17<00:02, 60.06it/s]Computing norms:  90%|████████▉ | 1015/1129 [00:17<00:01, 60.19it/s]Computing norms:  91%|█████████ | 1022/1129 [00:17<00:01, 60.11it/s]Computing norms:  91%|█████████ | 1029/1129 [00:17<00:01, 60.07it/s]Computing norms:  92%|█████████▏| 1036/1129 [00:18<00:01, 59.82it/s]Computing norms:  92%|█████████▏| 1043/1129 [00:18<00:01, 59.97it/s]Computing norms:  93%|█████████▎| 1050/1129 [00:18<00:01, 60.07it/s]Computing norms:  94%|█████████▎| 1057/1129 [00:18<00:01, 60.16it/s]Computing norms:  94%|█████████▍| 1064/1129 [00:18<00:01, 60.02it/s]Computing norms:  95%|█████████▍| 1071/1129 [00:18<00:00, 60.03it/s]Computing norms:  95%|█████████▌| 1078/1129 [00:18<00:00, 60.01it/s]Computing norms:  96%|█████████▌| 1085/1129 [00:18<00:00, 60.06it/s]Computing norms:  97%|█████████▋| 1092/1129 [00:18<00:00, 60.01it/s]Computing norms:  97%|█████████▋| 1099/1129 [00:19<00:00, 60.10it/s]Computing norms:  98%|█████████▊| 1106/1129 [00:19<00:00, 60.20it/s]Computing norms:  99%|█████████▊| 1113/1129 [00:19<00:00, 59.95it/s]Computing norms:  99%|█████████▉| 1119/1129 [00:19<00:00, 59.94it/s]Computing norms: 100%|█████████▉| 1126/1129 [00:19<00:00, 60.00it/s]Computing norms: 100%|██████████| 1129/1129 [00:19<00:00, 57.73it/s]
Map:   0%|          | 0/10000 [00:00<?, ? examples/s]Map:   0%|          | 32/10000 [00:02<12:32, 13.24 examples/s]Map:   1%|          | 64/10000 [00:03<08:55, 18.55 examples/s]Map:   1%|          | 96/10000 [00:05<08:42, 18.97 examples/s]Map:   1%|▏         | 128/10000 [00:06<07:24, 22.22 examples/s]Map:   2%|▏         | 160/10000 [00:08<08:12, 19.98 examples/s]Map:   2%|▏         | 192/10000 [00:10<08:57, 18.25 examples/s]Map:   2%|▏         | 224/10000 [00:12<09:17, 17.55 examples/s]Map:   3%|▎         | 256/10000 [00:14<09:27, 17.18 examples/s]Map:   3%|▎         | 288/10000 [00:16<09:21, 17.31 examples/s]Map:   3%|▎         | 320/10000 [00:17<08:47, 18.34 examples/s]Map:   4%|▎         | 352/10000 [00:18<07:48, 20.60 examples/s]Map:   4%|▍         | 384/10000 [00:20<07:47, 20.56 examples/s]Map:   4%|▍         | 416/10000 [00:21<07:06, 22.49 examples/s]Map:   4%|▍         | 448/10000 [00:23<07:47, 20.44 examples/s]Map:   5%|▍         | 480/10000 [00:25<08:11, 19.39 examples/s]Map:   5%|▌         | 512/10000 [00:26<08:08, 19.44 examples/s]Map:   5%|▌         | 544/10000 [00:28<07:41, 20.51 examples/s]Map:   6%|▌         | 576/10000 [00:29<08:00, 19.63 examples/s]Map:   6%|▌         | 608/10000 [00:30<06:58, 22.43 examples/s]Map:   6%|▋         | 640/10000 [00:32<06:53, 22.66 examples/s]Map:   7%|▋         | 672/10000 [00:34<07:30, 20.71 examples/s]Map:   7%|▋         | 704/10000 [00:35<06:48, 22.76 examples/s]Map:   7%|▋         | 736/10000 [00:36<06:13, 24.80 examples/s]Map:   8%|▊         | 768/10000 [00:37<05:50, 26.30 examples/s]Map:   8%|▊         | 800/10000 [00:38<06:30, 23.56 examples/s]Map:   8%|▊         | 832/10000 [00:40<07:21, 20.78 examples/s]Map:   9%|▊         | 864/10000 [00:42<07:37, 19.98 examples/s]Map:   9%|▉         | 896/10000 [00:44<07:54, 19.19 examples/s]Map:   9%|▉         | 928/10000 [00:46<08:15, 18.31 examples/s]Map:  10%|▉         | 960/10000 [00:48<08:35, 17.54 examples/s]Map:  10%|▉         | 992/10000 [00:50<08:30, 17.63 examples/s]Map:  10%|█         | 1024/10000 [00:51<08:16, 18.07 examples/s]Map:  11%|█         | 1056/10000 [00:53<08:39, 17.21 examples/s]Map:  11%|█         | 1088/10000 [00:55<08:32, 17.37 examples/s]Map:  11%|█         | 1120/10000 [00:57<08:49, 16.76 examples/s]Map:  12%|█▏        | 1152/10000 [00:59<08:40, 16.98 examples/s]Map:  12%|█▏        | 1184/10000 [01:01<08:14, 17.82 examples/s]Map:  12%|█▏        | 1216/10000 [01:02<08:04, 18.14 examples/s]Map:  12%|█▏        | 1248/10000 [01:04<08:06, 18.00 examples/s]Map:  13%|█▎        | 1280/10000 [01:06<08:09, 17.83 examples/s]Map:  13%|█▎        | 1312/10000 [01:08<08:29, 17.06 examples/s]Map:  13%|█▎        | 1344/10000 [01:10<08:09, 17.70 examples/s]Map:  14%|█▍        | 1376/10000 [01:12<08:24, 17.09 examples/s]Map:  14%|█▍        | 1408/10000 [01:13<07:59, 17.93 examples/s]Map:  14%|█▍        | 1440/10000 [01:15<08:13, 17.36 examples/s]Map:  15%|█▍        | 1472/10000 [01:17<07:44, 18.35 examples/s]Map:  15%|█▌        | 1504/10000 [01:18<07:12, 19.66 examples/s]Map:  15%|█▌        | 1536/10000 [01:19<06:42, 21.01 examples/s]Map:  16%|█▌        | 1568/10000 [01:21<06:25, 21.87 examples/s]Map:  16%|█▌        | 1600/10000 [01:22<06:16, 22.34 examples/s]Map:  16%|█▋        | 1632/10000 [01:23<06:08, 22.73 examples/s]Map:  17%|█▋        | 1664/10000 [01:25<06:00, 23.09 examples/s]Map:  17%|█▋        | 1696/10000 [01:26<05:58, 23.16 examples/s]Map:  17%|█▋        | 1728/10000 [01:28<05:54, 23.35 examples/s]Map:  18%|█▊        | 1760/10000 [01:29<05:29, 25.04 examples/s]Map:  18%|█▊        | 1792/10000 [01:29<04:37, 29.53 examples/s]Map:  18%|█▊        | 1824/10000 [01:30<04:39, 29.28 examples/s]Map:  19%|█▊        | 1856/10000 [01:31<04:06, 33.01 examples/s]Map:  19%|█▉        | 1888/10000 [01:32<03:40, 36.75 examples/s]Map:  19%|█▉        | 1920/10000 [01:32<03:22, 39.96 examples/s]Map:  20%|█▉        | 1952/10000 [01:33<03:12, 41.78 examples/s]Map:  20%|█▉        | 1984/10000 [01:35<04:17, 31.14 examples/s]Map:  20%|██        | 2016/10000 [01:36<04:39, 28.61 examples/s]Map:  20%|██        | 2048/10000 [01:37<04:59, 26.56 examples/s]Map:  21%|██        | 2080/10000 [01:39<05:19, 24.82 examples/s]Map:  21%|██        | 2112/10000 [01:40<05:22, 24.46 examples/s]Map:  21%|██▏       | 2144/10000 [01:42<05:26, 24.04 examples/s]Map:  22%|██▏       | 2176/10000 [01:43<05:23, 24.17 examples/s]Map:  22%|██▏       | 2208/10000 [01:44<05:25, 23.92 examples/s]Map:  22%|██▏       | 2240/10000 [01:46<05:56, 21.80 examples/s]Map:  23%|██▎       | 2272/10000 [01:47<05:41, 22.64 examples/s]Map:  23%|██▎       | 2304/10000 [01:49<05:33, 23.08 examples/s]Map:  23%|██▎       | 2336/10000 [01:50<05:32, 23.07 examples/s]Map:  24%|██▎       | 2368/10000 [01:52<06:16, 20.25 examples/s]Map:  24%|██▍       | 2400/10000 [01:54<06:48, 18.59 examples/s]Map:  24%|██▍       | 2432/10000 [01:56<07:15, 17.39 examples/s]Map:  25%|██▍       | 2464/10000 [01:58<07:30, 16.74 examples/s]Map:  25%|██▍       | 2496/10000 [02:00<07:05, 17.62 examples/s]Map:  25%|██▌       | 2528/10000 [02:02<07:10, 17.34 examples/s]Map:  26%|██▌       | 2560/10000 [02:03<06:09, 20.12 examples/s]Map:  26%|██▌       | 2592/10000 [02:03<05:01, 24.55 examples/s]Map:  26%|██▌       | 2624/10000 [02:04<04:40, 26.34 examples/s]Map:  27%|██▋       | 2656/10000 [02:06<04:43, 25.90 examples/s]Map:  27%|██▋       | 2688/10000 [02:07<04:40, 26.05 examples/s]Map:  27%|██▋       | 2720/10000 [02:08<04:23, 27.60 examples/s]Map:  28%|██▊       | 2752/10000 [02:09<04:34, 26.41 examples/s]Map:  28%|██▊       | 2784/10000 [02:11<04:41, 25.64 examples/s]Map:  28%|██▊       | 2816/10000 [02:12<04:45, 25.15 examples/s]Map:  28%|██▊       | 2848/10000 [02:13<04:39, 25.56 examples/s]Map:  29%|██▉       | 2880/10000 [02:14<04:12, 28.17 examples/s]Map:  29%|██▉       | 2912/10000 [02:15<03:57, 29.88 examples/s]Map:  29%|██▉       | 2944/10000 [02:16<03:36, 32.56 examples/s]Map:  30%|██▉       | 2976/10000 [02:18<04:41, 24.97 examples/s]Map:  30%|███       | 3008/10000 [02:19<05:12, 22.36 examples/s]Map:  30%|███       | 3040/10000 [02:21<05:29, 21.14 examples/s]Map:  31%|███       | 3072/10000 [02:22<05:15, 21.99 examples/s]Map:  31%|███       | 3104/10000 [02:24<05:11, 22.14 examples/s]Map:  31%|███▏      | 3136/10000 [02:26<05:25, 21.09 examples/s]Map:  32%|███▏      | 3168/10000 [02:27<05:28, 20.79 examples/s]Map:  32%|███▏      | 3200/10000 [02:28<04:51, 23.31 examples/s]Map:  32%|███▏      | 3232/10000 [02:29<04:31, 24.92 examples/s]Map:  33%|███▎      | 3264/10000 [02:31<04:53, 22.94 examples/s]Map:  33%|███▎      | 3296/10000 [02:33<05:08, 21.76 examples/s]Map:  33%|███▎      | 3328/10000 [02:34<05:19, 20.91 examples/s]Map:  34%|███▎      | 3360/10000 [02:36<05:04, 21.82 examples/s]Map:  34%|███▍      | 3392/10000 [02:37<05:28, 20.12 examples/s]Map:  34%|███▍      | 3424/10000 [02:38<04:53, 22.38 examples/s]Map:  35%|███▍      | 3456/10000 [02:40<04:45, 22.89 examples/s]Map:  35%|███▍      | 3488/10000 [02:41<04:53, 22.21 examples/s]Map:  35%|███▌      | 3520/10000 [02:43<05:17, 20.42 examples/s]Map:  36%|███▌      | 3552/10000 [02:45<05:08, 20.88 examples/s]Map:  36%|███▌      | 3584/10000 [02:46<04:44, 22.55 examples/s]Map:  36%|███▌      | 3616/10000 [02:48<05:16, 20.19 examples/s]Map:  36%|███▋      | 3648/10000 [02:50<05:32, 19.12 examples/s]Map:  37%|███▋      | 3680/10000 [02:51<05:10, 20.35 examples/s]Map:  37%|███▋      | 3712/10000 [02:53<05:20, 19.64 examples/s]Map:  37%|███▋      | 3744/10000 [02:54<05:03, 20.60 examples/s]Map:  38%|███▊      | 3776/10000 [02:56<04:59, 20.77 examples/s]Map:  38%|███▊      | 3808/10000 [02:57<05:01, 20.56 examples/s]Map:  38%|███▊      | 3840/10000 [02:59<05:20, 19.21 examples/s]Map:  39%|███▊      | 3872/10000 [03:00<04:59, 20.44 examples/s]Map:  39%|███▉      | 3904/10000 [03:02<04:45, 21.33 examples/s]Map:  39%|███▉      | 3936/10000 [03:03<04:33, 22.18 examples/s]Map:  40%|███▉      | 3968/10000 [03:05<04:59, 20.14 examples/s]Map:  40%|████      | 4000/10000 [03:07<05:03, 19.77 examples/s]Map:  40%|████      | 4032/10000 [03:08<04:53, 20.30 examples/s]Map:  41%|████      | 4064/10000 [03:10<04:47, 20.63 examples/s]Map:  41%|████      | 4096/10000 [03:11<04:48, 20.46 examples/s]Map:  41%|████▏     | 4128/10000 [03:13<04:59, 19.62 examples/s]Map:  42%|████▏     | 4160/10000 [03:14<04:40, 20.85 examples/s]Map:  42%|████▏     | 4192/10000 [03:15<03:55, 24.70 examples/s]Map:  42%|████▏     | 4224/10000 [03:16<03:47, 25.40 examples/s]Map:  43%|████▎     | 4256/10000 [03:17<03:28, 27.59 examples/s]Map:  43%|████▎     | 4288/10000 [03:19<03:37, 26.22 examples/s]Map:  43%|████▎     | 4320/10000 [03:20<03:53, 24.29 examples/s]Map:  44%|████▎     | 4352/10000 [03:22<04:01, 23.40 examples/s]Map:  44%|████▍     | 4384/10000 [03:23<04:03, 23.07 examples/s]Map:  44%|████▍     | 4416/10000 [03:24<04:01, 23.12 examples/s]Map:  44%|████▍     | 4448/10000 [03:26<04:00, 23.06 examples/s]Map:  45%|████▍     | 4480/10000 [03:27<04:04, 22.56 examples/s]Map:  45%|████▌     | 4512/10000 [03:29<03:52, 23.65 examples/s]Map:  45%|████▌     | 4544/10000 [03:30<04:06, 22.11 examples/s]Map:  46%|████▌     | 4576/10000 [03:32<04:28, 20.23 examples/s]Map:  46%|████▌     | 4608/10000 [03:34<04:47, 18.75 examples/s]Map:  46%|████▋     | 4640/10000 [03:36<04:45, 18.79 examples/s]Map:  47%|████▋     | 4672/10000 [03:37<04:37, 19.23 examples/s]Map:  47%|████▋     | 4704/10000 [03:39<04:17, 20.56 examples/s]Map:  47%|████▋     | 4736/10000 [03:40<04:01, 21.80 examples/s]Map:  48%|████▊     | 4768/10000 [03:41<03:52, 22.49 examples/s]Map:  48%|████▊     | 4800/10000 [03:43<03:46, 22.94 examples/s]Map:  48%|████▊     | 4832/10000 [03:45<04:10, 20.64 examples/s]Map:  49%|████▊     | 4864/10000 [03:45<03:37, 23.67 examples/s]Map:  49%|████▉     | 4896/10000 [03:47<03:38, 23.41 examples/s]Map:  49%|████▉     | 4928/10000 [03:48<03:42, 22.81 examples/s]Map:  50%|████▉     | 4960/10000 [03:50<04:09, 20.23 examples/s]Map:  50%|████▉     | 4992/10000 [03:52<04:13, 19.78 examples/s]Map:  50%|█████     | 5024/10000 [03:54<04:23, 18.86 examples/s]Map:  51%|█████     | 5056/10000 [03:56<04:38, 17.73 examples/s]Map:  51%|█████     | 5088/10000 [03:57<04:05, 20.02 examples/s]Map:  51%|█████     | 5120/10000 [03:58<03:51, 21.05 examples/s]Map:  52%|█████▏    | 5152/10000 [04:00<04:06, 19.69 examples/s]Map:  52%|█████▏    | 5184/10000 [04:02<04:22, 18.35 examples/s]Map:  52%|█████▏    | 5216/10000 [04:04<04:16, 18.63 examples/s]Map:  52%|█████▏    | 5248/10000 [04:05<03:49, 20.75 examples/s]Map:  53%|█████▎    | 5280/10000 [04:07<04:08, 18.97 examples/s]Map:  53%|█████▎    | 5312/10000 [04:09<04:18, 18.14 examples/s]Map:  53%|█████▎    | 5344/10000 [04:11<04:25, 17.51 examples/s]Map:  54%|█████▍    | 5376/10000 [04:13<04:13, 18.21 examples/s]Map:  54%|█████▍    | 5408/10000 [04:15<04:23, 17.40 examples/s]Map:  54%|█████▍    | 5440/10000 [04:16<04:12, 18.04 examples/s]Map:  55%|█████▍    | 5472/10000 [04:17<03:22, 22.35 examples/s]Map:  55%|█████▌    | 5504/10000 [04:18<03:15, 22.95 examples/s]Map:  55%|█████▌    | 5536/10000 [04:20<03:36, 20.60 examples/s]Map:  56%|█████▌    | 5568/10000 [04:22<03:38, 20.29 examples/s]Map:  56%|█████▌    | 5600/10000 [04:23<03:31, 20.76 examples/s]Map:  56%|█████▋    | 5632/10000 [04:24<03:03, 23.74 examples/s]Map:  57%|█████▋    | 5664/10000 [04:25<02:58, 24.25 examples/s]Map:  57%|█████▋    | 5696/10000 [04:27<03:17, 21.74 examples/s]Map:  57%|█████▋    | 5728/10000 [04:28<02:53, 24.68 examples/s]Map:  58%|█████▊    | 5760/10000 [04:29<02:54, 24.27 examples/s]Map:  58%|█████▊    | 5792/10000 [04:31<02:57, 23.69 examples/s]Map:  58%|█████▊    | 5824/10000 [04:32<02:53, 24.03 examples/s]Map:  59%|█████▊    | 5856/10000 [04:34<03:13, 21.43 examples/s]Map:  59%|█████▉    | 5888/10000 [04:36<03:12, 21.31 examples/s]Map:  59%|█████▉    | 5920/10000 [04:37<03:08, 21.66 examples/s]Map:  60%|█████▉    | 5952/10000 [04:38<02:56, 22.92 examples/s]Map:  60%|█████▉    | 5984/10000 [04:40<02:55, 22.92 examples/s]Map:  60%|██████    | 6016/10000 [04:40<02:30, 26.54 examples/s]Map:  60%|██████    | 6048/10000 [04:41<02:24, 27.33 examples/s]Map:  61%|██████    | 6080/10000 [04:43<02:36, 25.09 examples/s]Map:  61%|██████    | 6112/10000 [04:45<02:55, 22.11 examples/s]Map:  61%|██████▏   | 6144/10000 [04:47<03:17, 19.57 examples/s]Map:  62%|██████▏   | 6176/10000 [04:48<03:10, 20.03 examples/s]Map:  62%|██████▏   | 6208/10000 [04:50<03:05, 20.50 examples/s]Map:  62%|██████▏   | 6240/10000 [04:51<03:06, 20.21 examples/s]Map:  63%|██████▎   | 6272/10000 [04:53<03:05, 20.11 examples/s]Map:  63%|██████▎   | 6304/10000 [04:54<02:45, 22.35 examples/s]Map:  63%|██████▎   | 6336/10000 [04:56<02:52, 21.25 examples/s]Map:  64%|██████▎   | 6368/10000 [04:57<02:49, 21.41 examples/s]Map:  64%|██████▍   | 6400/10000 [04:59<02:50, 21.17 examples/s]Map:  64%|██████▍   | 6432/10000 [05:00<02:48, 21.19 examples/s]Map:  65%|██████▍   | 6464/10000 [05:02<02:41, 21.85 examples/s]Map:  65%|██████▍   | 6496/10000 [05:04<02:55, 19.97 examples/s]Map:  65%|██████▌   | 6528/10000 [05:05<03:02, 19.05 examples/s]Map:  66%|██████▌   | 6560/10000 [05:07<03:09, 18.19 examples/s]Map:  66%|██████▌   | 6592/10000 [05:08<02:37, 21.59 examples/s]Map:  66%|██████▌   | 6624/10000 [05:10<02:38, 21.24 examples/s]Map:  67%|██████▋   | 6656/10000 [05:12<02:52, 19.43 examples/s]Map:  67%|██████▋   | 6688/10000 [05:14<03:00, 18.38 examples/s]Map:  67%|██████▋   | 6720/10000 [05:16<03:06, 17.63 examples/s]Map:  68%|██████▊   | 6752/10000 [05:17<02:51, 18.93 examples/s]Map:  68%|██████▊   | 6784/10000 [05:19<02:50, 18.91 examples/s]Map:  68%|██████▊   | 6816/10000 [05:20<02:35, 20.45 examples/s]Map:  68%|██████▊   | 6848/10000 [05:22<02:47, 18.84 examples/s]Map:  69%|██████▉   | 6880/10000 [05:24<02:55, 17.77 examples/s]Map:  69%|██████▉   | 6912/10000 [05:26<02:45, 18.65 examples/s]Map:  69%|██████▉   | 6944/10000 [05:28<02:53, 17.65 examples/s]Map:  70%|██████▉   | 6976/10000 [05:29<02:47, 18.04 examples/s]Map:  70%|███████   | 7008/10000 [05:31<02:49, 17.66 examples/s]Map:  70%|███████   | 7040/10000 [05:33<02:44, 18.00 examples/s]Map:  71%|███████   | 7072/10000 [05:35<02:43, 17.95 examples/s]Map:  71%|███████   | 7104/10000 [05:37<02:43, 17.72 examples/s]Map:  71%|███████▏  | 7136/10000 [05:39<02:44, 17.37 examples/s]Map:  72%|███████▏  | 7168/10000 [05:40<02:44, 17.25 examples/s]Map:  72%|███████▏  | 7200/10000 [05:41<02:19, 20.10 examples/s]Map:  72%|███████▏  | 7232/10000 [05:43<02:08, 21.47 examples/s]Map:  73%|███████▎  | 7264/10000 [05:44<01:57, 23.35 examples/s]Map:  73%|███████▎  | 7296/10000 [05:45<01:59, 22.70 examples/s]Map:  73%|███████▎  | 7328/10000 [05:47<02:04, 21.53 examples/s]Map:  74%|███████▎  | 7360/10000 [05:48<01:59, 22.18 examples/s]Map:  74%|███████▍  | 7392/10000 [05:50<02:06, 20.67 examples/s]Map:  74%|███████▍  | 7424/10000 [05:52<02:17, 18.77 examples/s]Map:  75%|███████▍  | 7456/10000 [05:54<02:22, 17.87 examples/s]Map:  75%|███████▍  | 7488/10000 [05:56<02:12, 18.90 examples/s]Map:  75%|███████▌  | 7520/10000 [05:57<02:03, 20.06 examples/s]Map:  76%|███████▌  | 7552/10000 [05:59<02:03, 19.77 examples/s]Map:  76%|███████▌  | 7584/10000 [06:00<01:59, 20.14 examples/s]Map:  76%|███████▌  | 7616/10000 [06:02<01:53, 20.95 examples/s]Map:  76%|███████▋  | 7648/10000 [06:03<01:46, 22.15 examples/s]Map:  77%|███████▋  | 7680/10000 [06:04<01:29, 25.80 examples/s]Map:  77%|███████▋  | 7712/10000 [06:05<01:30, 25.15 examples/s]Map:  77%|███████▋  | 7744/10000 [06:07<01:37, 23.16 examples/s]Map:  78%|███████▊  | 7776/10000 [06:08<01:38, 22.67 examples/s]Map:  78%|███████▊  | 7808/10000 [06:09<01:33, 23.33 examples/s]Map:  78%|███████▊  | 7840/10000 [06:11<01:45, 20.54 examples/s]Map:  79%|███████▊  | 7872/10000 [06:13<01:41, 20.91 examples/s]Map:  79%|███████▉  | 7904/10000 [06:15<01:51, 18.79 examples/s]Map:  79%|███████▉  | 7936/10000 [06:17<01:56, 17.78 examples/s]Map:  80%|███████▉  | 7968/10000 [06:19<01:56, 17.44 examples/s]Map:  80%|████████  | 8000/10000 [06:21<01:57, 16.98 examples/s]Map:  80%|████████  | 8032/10000 [06:22<01:46, 18.54 examples/s]Map:  81%|████████  | 8064/10000 [06:24<01:37, 19.91 examples/s]Map:  81%|████████  | 8096/10000 [06:25<01:31, 20.76 examples/s]Map:  81%|████████▏ | 8128/10000 [06:27<01:36, 19.33 examples/s]Map:  82%|████████▏ | 8160/10000 [06:28<01:32, 19.80 examples/s]Map:  82%|████████▏ | 8192/10000 [06:30<01:28, 20.54 examples/s]Map:  82%|████████▏ | 8224/10000 [06:31<01:22, 21.42 examples/s]Map:  83%|████████▎ | 8256/10000 [06:32<01:15, 23.08 examples/s]Map:  83%|████████▎ | 8288/10000 [06:33<01:10, 24.18 examples/s]Map:  83%|████████▎ | 8320/10000 [06:35<01:09, 24.01 examples/s]Map:  84%|████████▎ | 8352/10000 [06:36<01:09, 23.68 examples/s]Map:  84%|████████▍ | 8384/10000 [06:37<01:05, 24.62 examples/s]Map:  84%|████████▍ | 8416/10000 [06:38<00:58, 27.18 examples/s]Map:  84%|████████▍ | 8448/10000 [06:39<00:49, 31.59 examples/s]Map:  85%|████████▍ | 8480/10000 [06:40<00:45, 33.24 examples/s]Map:  85%|████████▌ | 8512/10000 [06:40<00:40, 36.57 examples/s]Map:  85%|████████▌ | 8544/10000 [06:41<00:36, 39.96 examples/s]Map:  86%|████████▌ | 8576/10000 [06:43<00:49, 28.90 examples/s]Map:  86%|████████▌ | 8608/10000 [06:45<00:55, 25.25 examples/s]Map:  86%|████████▋ | 8640/10000 [06:47<01:03, 21.52 examples/s]Map:  87%|████████▋ | 8672/10000 [06:48<01:02, 21.16 examples/s]Map:  87%|████████▋ | 8704/10000 [06:49<00:59, 21.64 examples/s]Map:  87%|████████▋ | 8736/10000 [06:51<00:58, 21.62 examples/s]Map:  88%|████████▊ | 8768/10000 [06:52<00:56, 21.99 examples/s]Map:  88%|████████▊ | 8800/10000 [06:54<00:53, 22.44 examples/s]Map:  88%|████████▊ | 8832/10000 [06:55<00:51, 22.78 examples/s]Map:  89%|████████▊ | 8864/10000 [06:57<00:56, 20.11 examples/s]Map:  89%|████████▉ | 8896/10000 [06:59<00:54, 20.18 examples/s]Map:  89%|████████▉ | 8928/10000 [07:00<00:51, 20.95 examples/s]Map:  90%|████████▉ | 8960/10000 [07:02<00:52, 19.98 examples/s]Map:  90%|████████▉ | 8992/10000 [07:03<00:50, 19.92 examples/s]Map:  90%|█████████ | 9024/10000 [07:05<00:51, 18.98 examples/s]Map:  91%|█████████ | 9056/10000 [07:07<00:50, 18.73 examples/s]Map:  91%|█████████ | 9088/10000 [07:08<00:45, 20.02 examples/s]Map:  91%|█████████ | 9120/10000 [07:10<00:41, 21.08 examples/s]Map:  92%|█████████▏| 9152/10000 [07:11<00:38, 22.06 examples/s]Map:  92%|█████████▏| 9184/10000 [07:12<00:34, 23.35 examples/s]Map:  92%|█████████▏| 9216/10000 [07:14<00:35, 21.95 examples/s]Map:  92%|█████████▏| 9248/10000 [07:15<00:33, 22.23 examples/s]Map:  93%|█████████▎| 9280/10000 [07:16<00:29, 24.29 examples/s]Map:  93%|█████████▎| 9312/10000 [07:17<00:24, 27.80 examples/s]Map:  93%|█████████▎| 9344/10000 [07:18<00:21, 31.11 examples/s]Map:  94%|█████████▍| 9376/10000 [07:19<00:20, 30.83 examples/s]Map:  94%|█████████▍| 9408/10000 [07:20<00:18, 31.32 examples/s]Map:  94%|█████████▍| 9440/10000 [07:21<00:17, 32.00 examples/s]Map:  95%|█████████▍| 9472/10000 [07:22<00:15, 33.01 examples/s]Map:  95%|█████████▌| 9504/10000 [07:22<00:13, 37.14 examples/s]Map:  95%|█████████▌| 9536/10000 [07:23<00:11, 40.31 examples/s]Map:  96%|█████████▌| 9568/10000 [07:24<00:11, 36.46 examples/s]Map:  96%|█████████▌| 9600/10000 [07:25<00:10, 39.11 examples/s]Map:  96%|█████████▋| 9632/10000 [07:26<00:10, 36.07 examples/s]Map:  97%|█████████▋| 9664/10000 [07:27<00:09, 34.90 examples/s]Map:  97%|█████████▋| 9696/10000 [07:28<00:09, 31.52 examples/s]Map:  97%|█████████▋| 9728/10000 [07:29<00:08, 33.60 examples/s]Map:  98%|█████████▊| 9760/10000 [07:29<00:06, 36.69 examples/s]Map:  98%|█████████▊| 9792/10000 [07:31<00:06, 32.54 examples/s]Map:  98%|█████████▊| 9824/10000 [07:32<00:05, 29.84 examples/s]Map:  99%|█████████▊| 9856/10000 [07:33<00:05, 27.12 examples/s]Map:  99%|█████████▉| 9888/10000 [07:35<00:04, 25.30 examples/s]Map:  99%|█████████▉| 9920/10000 [07:36<00:02, 30.00 examples/s]Map: 100%|█████████▉| 9952/10000 [07:36<00:01, 34.10 examples/s]Map: 100%|█████████▉| 9984/10000 [07:37<00:00, 37.65 examples/s]Map: 100%|██████████| 10000/10000 [07:38<00:00, 33.22 examples/s]                                                                 torch.Size([1024])
Computing matrix:   0%|          | 0/1129 [00:00<?, ?it/s]Computing matrix:   5%|▌         | 60/1129 [00:00<00:01, 591.19it/s]Computing matrix:  11%|█         | 120/1129 [00:00<00:01, 593.55it/s]Computing matrix:  16%|█▌        | 180/1129 [00:00<00:01, 595.19it/s]Computing matrix:  21%|██▏       | 241/1129 [00:00<00:01, 597.62it/s]Computing matrix:  27%|██▋       | 301/1129 [00:00<00:01, 595.62it/s]Computing matrix:  32%|███▏      | 361/1129 [00:00<00:01, 577.73it/s]Computing matrix:  37%|███▋      | 419/1129 [00:00<00:01, 573.93it/s]Computing matrix:  42%|████▏     | 477/1129 [00:00<00:01, 570.19it/s]Computing matrix:  47%|████▋     | 535/1129 [00:00<00:01, 568.18it/s]Computing matrix:  52%|█████▏    | 592/1129 [00:01<00:00, 562.75it/s]Computing matrix:  57%|█████▋    | 649/1129 [00:01<00:00, 562.45it/s]Computing matrix:  63%|██████▎   | 706/1129 [00:01<00:00, 562.18it/s]Computing matrix:  68%|██████▊   | 763/1129 [00:01<00:00, 455.35it/s]Computing matrix:  73%|███████▎  | 820/1129 [00:01<00:00, 482.61it/s]Computing matrix:  78%|███████▊  | 877/1129 [00:01<00:00, 504.31it/s]Computing matrix:  83%|████████▎ | 934/1129 [00:01<00:00, 521.14it/s]Computing matrix:  88%|████████▊ | 990/1129 [00:01<00:00, 530.11it/s]Computing matrix:  93%|█████████▎| 1046/1129 [00:01<00:00, 537.68it/s]Computing matrix:  98%|█████████▊| 1102/1129 [00:02<00:00, 542.68it/s]Computing matrix: 100%|██████████| 1129/1129 [00:02<00:00, 546.35it/s]
[[0.84716158 0.81342981 0.83920735 ... 0.82218332 0.84405168 0.85046046]
 [0.86049694 0.79163078 0.82722491 ... 0.83101525 0.80857775 0.84868929]
 [0.85181066 0.80105565 0.85690043 ... 0.85181504 0.83512114 0.85177704]
 ...
 [0.84167167 0.83951346 0.86383607 ... 0.82329569 0.84035256 0.85053203]
 [0.83280077 0.81635791 0.8372661  ... 0.81569891 0.86319211 0.81845156]
 [0.8369016  0.83229374 0.84639328 ... 0.81468939 0.85820013 0.83153514]]
(1129, 10000)
[[ 0.0105539  -0.02317787  0.00259967 ... -0.01442436  0.007444
   0.01385277]
 [ 0.03408034 -0.03478581  0.00080832 ...  0.00459865 -0.01783885
   0.0222727 ]
 [ 0.01577383 -0.03498118  0.02086361 ...  0.01577821 -0.00091568
   0.01574021]
 ...
 [ 0.00396372  0.0018055   0.02612811 ... -0.01441227  0.00264461
   0.01282408]
 [-0.00345304 -0.0198959   0.00101229 ... -0.02055491  0.0269383
  -0.01780226]
 [ 0.0012804  -0.00332745  0.01077208 ... -0.02093181  0.02257894
  -0.00408606]]
(1129, 10000)
Sorting indices
[ 374324 8957386  456009 3503199 1373240 9412363 6124054 5308265 4702343
 4640369]
Sorted indices
Writing to csv
Sorting indices
[ 4702343  9412363  1373240  4640369 10406996  5143240   374324  5308265
  8957386 10332343]
Sorted indices
Writing to csv
